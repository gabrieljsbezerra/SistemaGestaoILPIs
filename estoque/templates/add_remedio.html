{% extends 'base.html' %}
{% load filters %}

{% block body %}
<div class="container">
    {% if messages %}
    <br>
    {% for message in messages %}
        <div class="alert {{message.tags}}">{{message}}</div>
    {% endfor %}
    {% endif %}
    <h2 class="mb-4">Cadastrar Remédio</h2>
    <form action="{% url 'add_remedio' %}" method="POST" enctype="multipart/form-data" class="needs-validation" novalidate>
    {% csrf_token %}

        <div class="mb-3">
          <label for="imagens" class="form-label">Imagens:</label>
          <input class="form-control" type="file" name="imagens" id="imagens" multiple>
        </div>      
        <div class="mb-3">
          <label for="nome" class="form-label">Nome:</label>
          <input class="form-control" type="text" name="nome" id="nome" required>
        </div>      
        <div class="mb-3">
          <label for="categoria" class="form-label">Categoria:</label>
          <select class="form-select" name="categoria" id="categoria" required>
            {% for categoria in categorias %}
              <option value="{{ categoria.id }}">{{ categoria.tipo }}</option>
            {% endfor %}
          </select>
        </div>      
        <div class="mb-3">
          <label for="marca" class="form-label">Marca:</label>
          <input class="form-control" type="text" name="marca" id="marca">
        </div>      
        <div class="mb-3">
          <label for="quantidade" class="form-label">Quantidade:</label>
          <input class="form-control" type="number" name="quantidade" id="quantidade">
        </div>      
        <div class="mb-3">
          <label for="preco_compra" class="form-label">Custo:</label>
          <input class="form-control" type="number" name="preco_compra" id="preco_compra" step="0.01">
        </div>      
        <button type="submit" class="btn btn-success">Salvar</button>
    </form>
    <!-- Lista -->
<!-- Lista de Remédios com Cards -->
<hr class="bg-hr mb-4">

<div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
  {% for remedio in remedios %}
  <div class="col">
    <div class="card h-100 rounded-4 shadow-sm border-0" style="background-color: var(--card); color: var(--text);">
      
      {% if remedio|get_first_image %}
      <div class="ratio ratio-4x3 bg-light rounded-top overflow-hidden border-bottom" style="background-color: #f1f1f1;">
        <img width="100%" src="{{ remedio|get_first_image }}" class="img-fluid object-fit-cover" style="width: 100%; height: 100%; object-fit: cover;" alt="{{ remedio.nome }}">
      </div>
      {% endif %}

      <div class="card-body">
        <h5 class="card-title fw-semibold">{{ remedio.nome }}</h5>
        <ul class="list-unstyled small">
          <li><strong>Categoria:</strong> {{ remedio.categoria }}</li>
          <li><strong>Marca:</strong> {{ remedio.marca }}</li>
          <li><strong>Estoque:</strong> {{ remedio.quantidade }}</li>
          <li><strong>Custo:</strong> R$ {{ remedio.preco_compra }}</li>
        </ul>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

</div>
{% endblock %}
